{"version":3,"file":"main-app.js","sources":["../../../../qortal-ui-core/src/plugins/streams.js","../../../../qortal-ui-core/src/components/main-app.js"],"sourcesContent":["import { store } from '../store.js'\nimport { EpmlStream } from 'epml'\n\nconst LOGIN_STREAM_NAME = 'logged_in'\nconst CONFIG_STREAM_NAME = 'config'\nconst SELECTED_ADDRESS_STREAM_NAME = 'selected_address'\n\nexport const loggedInStream = new EpmlStream(LOGIN_STREAM_NAME, () => store.getState().app.loggedIn)\nexport const configStream = new EpmlStream(CONFIG_STREAM_NAME, () => store.getState().config)\nexport const selectedAddressStream = new EpmlStream(SELECTED_ADDRESS_STREAM_NAME, () => store.getState().app.selectedAddress)\n\n// const INTERVAL = 10 * 60 * 1000 // 10 minutes\n\nlet oldState = {\n    app: {}\n}\n\nlet pingInterval\n\n// protocol: 'http',\n//     domain: '127.0.0.1',\n//         port: 4999,\n//             url: '/airdrop/',\n//                 dhcpUrl: '/airdrop/ping/'\n\nstore.subscribe(() => {\n    const state = store.getState()\n    if (oldState.app.loggedIn !== state.app.loggedIn) {\n        loggedInStream.emit(state.app.loggedIn)\n    }\n    // This one may be a little on the heavy side...AHHH, NEED TO MOVE STORAGE OF ENCRYPTED SEED. DONE <3\n    if (oldState.config !== state.config) {\n        configStream.emit(state.config)\n    }\n    if (oldState.app.selectedAddress !== state.app.selectedAddress) {\n        // console.log('Selected address changed')\n        // selectedAddressStream.emit(state.selectedAddress)\n        selectedAddressStream.emit({\n            address: state.app.selectedAddress.address,\n            color: state.app.selectedAddress.color,\n            nonce: state.app.selectedAddress.nonce,\n            textColor: state.app.selectedAddress.textColor\n        })\n\n        // Don't think we want this crap\n        // if (state.app.selectedAddress.address) {\n        //     const node = store.getState().config.coin.node.airdrop\n        //     const fn = () => {\n        //         console.log('PINGING DHCP')\n        //         const url = node.protocol + '://' + node.domain + ':' + node.port + node.dhcpUrl + state.app.wallet.addresses[0].address\n        //         console.log(url)\n        //         fetch(url, { mode: 'no-cors' }).then(res => console.log('Ping resonse', res)).catch(err => console.error('Ping error', err))\n        //     }\n        //     pingInterval = setInterval(fn, node.pingInterval)\n        //     fn()\n        // }\n    }\n    oldState = state\n})\n","/* STUFF THAT WE'RE NOT USING RESOLVE...WE'RE IMPORTING THE FILES DIRECTLY */\nimport { LitElement, html } from 'lit-element'\nimport { installRouter } from 'pwa-helpers/router.js'\n// import { LitElement, html, css, unsafeCSS } from 'lit-element'\n// Feel like I need to use sass for every element and just import it all individually...may result in some duplicate sass I guess\n// ...but maybe the bundler can be smart...doubt it\nimport { connect } from 'pwa-helpers'\nimport { store } from '../store.js'\nimport { doNavigate } from '../redux/app/app-actions.js'\nimport '../plugins/streams.js'\n\nimport '../styles/app-styles.js'\n// import styles from '../styles/styles.scss'\n// import './app-view.js'\nimport './login-view/login-view.js'\n\n// import './confirm-transaction-dialog.js'\nimport '../functional-components/confirm-transaction-dialog.js'\n\n// import('./app-view.js') // Async\nimport './app-view.js' // Screw em then, let's make ff work\n\ninstallRouter((location) => store.dispatch(doNavigate(location)))\n\n// console.log('==============')\n// console.log(styles)\n// console.log('==============')\n\nclass MainApp extends connect(store)(LitElement) {\n    static get properties() {\n        return {\n            name: { type: 'String' },\n            loggedIn: { type: Boolean }\n        }\n    }\n\n    static get styles() {\n        return [\n            // css`\n            //     ${unsafeCSS(styles)}\n            // `\n            // css(styles)\n        ]\n    }\n\n    // constructor () {\n    //     super()\n    // }\n    //  ?hidden=${!this.loggedIn}\n    render() {\n        return html`\n            <!-- <app-styles></app-styles> -->\n            <!-- Core layout goes here? Then the log out button can go alongside the log out button...and scale down to it? -->\n            <!-- No. login-view will go inside of app-view. Theme, plugin loading, and maybe the web workers will go here. -->\n            \n            <login-view></login-view>\n            \n            <app-view></app-view> <!-- Might dynamic import this one... YUP DEFINITELY :) -->\n            \n            <!-- <confirm-transaction-dialog></confirm-transaction-dialog> -->\n\n            <!-- <input type=\"text\" placeholder=\"name\" value=\"${this.name}\" @input=${this._nameChanged}> -->\n        `\n    }\n\n    _nameChanged(e) {\n        // store.dispatch(updateName(e.target.value))\n    }\n\n    stateChanged(state) {\n        // this.name = state.test.name\n        this.loggedIn = state.app.loggedIn\n        document.title = state.config.coin.name\n    }\n\n    connectedCallback() {\n        super.connectedCallback()\n    }\n}\n\nwindow.customElements.define('main-app', MainApp)\n"],"names":[],"mappings":"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"}